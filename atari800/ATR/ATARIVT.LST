0 BLANK=2000›1 DLI=5000›2 GRAPHICS 0›3 GOSUB DLI›10 REM INIT -------------------------›12 SETCOLOR 1,12,6:SETCOLOR 2,12,3›13 SETCOLOR 4,12,3›20 POKE 752,1:POKE 77,0›25 POKE 65,0:POKE 755,0›50 DIM F$(1280*2),F1$(40),E$(40)›52 DIM F2$(1280)›55 FLIP=0:ERRS=0›60 DL=PEEK(560)+PEEK(561)*256›70 SA=ADR(F$)›75 SH=INT(SA/256)›80 SL=INT(SA-SH*256)›90 GOSUB BLANK›100 REM SPLASH ----------------------›110 TRAP 1000:OPEN #1,4,0,"D1:SPLASH.DAT"›115 TRAP 1100›120 FOR I=1 TO 21›130 INPUT #1,F1$›140 POSITION 1,I:PRINT F1$:NEXT I›145 CLOSE #1›160 FOR X=1 TO 500:NEXT X›165 GRAPHICS 0›166 POKE 752,1:POKE 77,0›167 POKE 65,0:POKE 755,0›168 SETCOLOR 1,12,6:SETCOLOR 2,12,3›169 SETCOLOR 4,12,3›170 POKE 77,120›180 GOSUB BLANK›190 GOTO 1000›200 TRAP 1000›202 POKE DL+4,SL:POKE DL+5,SH+FLIP*4›205 IF FLIP=0 THEN FLIP=1:GOTO 220›206 IF FLIP=1 THEN FLIP=0:GOTO 220›220 OPEN #1,4,0,"H:FRAME.DAT"›230 POKE 88,SL:POKE 89,SH+FLIP*4›235 TRAP 1100›240 FOR I=0 TO 22›250 INPUT #1,F1$›260 POSITION 0,I:PRINT F1$(1,39)›270 NEXT I›280 CLOSE #1›290 POKE DL+4,SL:POKE DL+5,SH+FLIP*4›295 ERRS=0›300 GOTO 200›1000 REM FRAME NOT FOUND ------------›1010 E$="CONNECTING TO SERVER"›1020 GOTO 1200›1100 REM BAD FRAME ------------------›1105 POKE 77,120›1106 CLOSE #1›1110 GOTO 200›1200 REM ERROR HANDLER --------------›1205 GOSUB BLANK›1208 POKE 88,SL:POKE 89,SH+FLIP*4›1210 POSITION 10,11›1220 PRINT E$›1230 POKE DL+4,SL:POKE DL+5,SH+FLIP*4›1235 FOR X=1 TO 200:NEXT X›1240 CLOSE #1›1250 GOTO 200›2000 REM BLANK THE PAGES›2010 F$=CHR$(0):F$(1280*2)=CHR$(0)›2030 F$(2)=F$›2035 FOR X=1 TO 100:NEXT X›2040 RETURN ›5000 GRAPHICS 0›5005 RESTORE ›5010 DLIST=PEEK(560)+256*PEEK(561):REM Find display list›5020 FOR J=6 TO 24:REM Give every mode line a DLI›5030 POKE DLIST+J,130:REM BASIC mode 7 with DLI bit set›5040 NEXT J›5050 FOR J=0 TO 30›5060 READ A:POKE 1536+J,A:NEXT J:REM Poke in DLI service routine›5070 DATA 72,138,72,238,32,6,175,32,6›5080 DATA 189,0,240,141,10,212,141,23,208›5090 DATA 224,79,208,5,169,0›5100 DATA 141,32,6,104,170,104,64›5110 POKE 512,0:POKE 513,6:REM Vector to DLI service routine›5120 POKE 54286,192:REM Enable DLI›5130 RETURN ›